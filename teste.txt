#criar estrutura

#cria l1d a=8, l=64, c=32KB, n=64 (lookup 6, offset 6, tag 20)
cl1d 32768 8 64

#cria l1i a=4, l=64, c=32KB, n=128 (lookup 7, offset 6, tag 19)
cl1i 32768 4 64

#cria l2 a=8, l=64, c=256KB, n=512 (lookup 9, offset 6, tag 17)
cl2 262144 8 64

#cria l3 a=16, l=128, c=8MB, n=4096 (lookup 12, offset 7, tag 13)
cl3 8388608 16 128

#cria mp 32MB (33554432)+ 64MB (67108864) # capacidade 236716032 enderecos 0 a 236716031
cmp 33554432 67108864

#cria hierarquia de memoria
cmem

#cria processador com 2 nucleos
cp 2



#Teste inicial: enderecos fora do espaco de enderecamento
#32MB + 64MB = 96MB. O numero 96M eh 0x6000000
#O intervalo de enderecos eh [0,0x5FFFFFF]
#endereco negativo deve dar erro
ri 0 -100
rd 0 -100

#endereco fora do espaco em bytes deve dar erro
ri 1 100663296
rd 1 100663296

#endereco fora do espaco em int nao deve dar erro
#O intervalo de enderecos eh salvo em um vetor de int com intervalo de indices [0,0x017FFFFF]
ri 1 33554432
rd 1 33554432

#-1: 4 ocorrencias e 4: 2 ocorrencia, ate aqui


#criar dados
#
#
#Formato dos enderecos (t:tag, l:lookup, o:offset)
#tttt tttt tttt tttt tttt llll lloo oooo (l1d e l1i)
#tttt tttt tttt tttt tlll llll lloo oooo (l2)
#tttt tttt tttt tlll llll llll looo oooo (l3)
#Os enderecos 0x00A00000 a 0x00A0003F sao uma linha de l1 e l2 com lookup 0
#Vamos escrever valores incrementais nesses enderecos.
wdi 0 10485760 1
wd 0 10485764 2
wd 0 10485768 3
wd 0 10485772 4
wd 0 10485776 5
wd 0 10485780 6
wd 0 10485784 7
wd 0 10485788 8
wd 0 10485792 9
wd 0 10485796 10
wd 0 10485800 11
wd 0 10485804 12
wd 0 10485808 13
wd 0 10485812 14
wd 0 10485816 15
wd 0 10485820 16

#A escrita do primeiro valor, vai dar um Miss em l1, l2 e l3 (retorna 4), mas as outras 15 escritas darao hit em l1 (retorno 1)
#Os enderecos 0x00A00040 a 0x00A0007F sao uma linha de l1 e l2 com lookup 1
#Mas, em l3 estao na mesma linha ja buscada, que inclui os enderecos 0x00A00000 a 0x00A0007F com lookup 0
#Vamos escrever valores incrementais nesses enderecos.
wd 0 10485824 17
wd 0 10485828 18
wd 0 10485832 19
wd 0 10485836 20
wd 0 10485840 21
wd 0 10485844 22
wd 0 10485848 23
wd 0 10485852 24
wd 0 10485856 25
wd 0 10485860 26
wd 0 10485864 27
wd 0 10485868 28
wd 0 10485872 29
wd 0 10485876 30
wd 0 10485880 31
wd 0 10485884 32

#A escrita do primeiro valor, vai dar um Miss em l1 e l2, mas hit l3 (retorna 3), mas as outras 15 escritas darao hit em l1 (retorno 1)
#Agora vamos lotar as TACaches de lookup 0 em l1d e l2, e preencher metade de 8 linhas da TACache de lookup 0 da l3. Fazemos isto repetindo o que foi feito acima, mas para 7 novas tags
wd 0 11534336 33
wd 0 11534340 34
wd 0 11534344 35
wd 0 11534348 36
wd 0 11534352 37
wd 0 11534356 38
wd 0 11534360 39
wd 0 11534364 40
wd 0 11534368 41
wd 0 11534372 42
wd 0 11534376 43
wd 0 11534380 44
wd 0 11534384 45
wd 0 11534388 46
wd 0 11534392 47
wd 0 11534396 48
wd 0 12582912 49
wd 0 12582916 50
wd 0 12582920 51
wd 0 12582924 52
wd 0 12582928 53
wd 0 12582932 54
wd 0 12582936 55
wd 0 12582940 56
wd 0 12582944 57
wd 0 12582948 58
wd 0 12582952 59
wd 0 12582956 60
wd 0 12582960 61
wd 0 12582964 62
wd 0 12582968 63
wd 0 12582972 64
wd 0 13631488 65
wd 0 13631492 66
wd 0 13631496 67
wd 0 13631500 68
wd 0 13631504 69
wd 0 13631508 70
wd 0 13631512 71
wd 0 13631516 72
wd 0 13631520 73
wd 0 13631524 74
wd 0 13631528 75
wd 0 13631532 76
wd 0 13631536 77
wd 0 13631540 78
wd 0 13631544 79
wd 0 13631548 80
wd 0 14680064 81
wd 0 14680068 82
wd 0 14680072 83
wd 0 14680076 84
wd 0 14680080 85
wd 0 14680084 86
wd 0 14680088 87
wd 0 14680092 88
wd 0 14680096 89
wd 0 14680100 90
wd 0 14680104 91
wd 0 14680108 92
wd 0 14680112 93
wd 0 14680116 94
wd 0 14680120 95
wd 0 14680124 96
wd 0 15728640 97
wd 0 15728644 98
wd 0 15728648 99
wd 0 15728652 100
wd 0 15728656 101
wd 0 15728660 102
wd 0 15728664 103
wd 0 15728668 104
wd 0 15728672 105
wd 0 15728676 106
wd 0 15728680 107
wd 0 15728684 108
wd 0 15728688 109
wd 0 15728692 110
wd 0 15728696 111
wd 0 15728700 112
wd 0 16777216 113
wd 0 16777220 114
wd 0 16777224 115
wd 0 16777228 116
wd 0 16777232 117
wd 0 16777236 118
wd 0 16777240 119
wd 0 16777244 120
wd 0 16777248 121
wd 0 16777252 122
wd 0 16777256 123
wd 0 16777260 124
wd 0 16777264 125
wd 0 16777268 126
wd 0 16777272 127
wd 0 16777276 128
wd 0 17825792 129
wd 0 17825796 130
wd 0 17825800 131
wd 0 17825804 132
wd 0 17825808 133
wd 0 17825812 134
wd 0 17825816 135
wd 0 17825820 136
wd 0 17825824 137
wd 0 17825828 138
wd 0 17825832 139
wd 0 17825836 140
wd 0 17825840 141
wd 0 17825844 142
wd 0 17825848 143
wd 0 17825852 144

#A escrita do primeiro valor, para cada tag, da miss em todos os niveis, e os 15 demais dao hit em l1. Como sao 7 tags, teremos 7 retornos 4 e 105 retornos 1
#Agora vamos lotar as TACaches de lookup 1 em l1d e l2, e preencher a outra metade das mesmas 8 linhas TACache de lookup 0 da l3, lotando-a. Fazemos isto repetindo o que foi feito acima, mas para 7 novas tags
wd 0 11534400 145
wd 0 11534404 146
wd 0 11534408 147
wd 0 11534412 148
wd 0 11534416 149
wd 0 11534420 150
wd 0 11534424 151
wd 0 11534428 152
wd 0 11534432 153
wd 0 11534436 154
wd 0 11534440 155
wd 0 11534444 156
wd 0 11534448 157
wd 0 11534452 158
wd 0 11534456 159
wd 0 11534460 160
wd 0 12582976 161
wd 0 12582980 162
wd 0 12582984 163
wd 0 12582988 164
wd 0 12582992 165
wd 0 12582996 166
wd 0 12583000 167
wd 0 12583004 168
wd 0 12583008 169
wd 0 12583012 170
wd 0 12583016 171
wd 0 12583020 172
wd 0 12583024 173
wd 0 12583028 174
wd 0 12583032 175
wd 0 12583036 176
wd 0 13631552 177
wd 0 13631556 178
wd 0 13631560 179
wd 0 13631564 180
wd 0 13631568 181
wd 0 13631572 182
wd 0 13631576 183
wd 0 13631580 184
wd 0 13631584 185
wd 0 13631588 186
wd 0 13631592 187
wd 0 13631596 188
wd 0 13631600 189
wd 0 13631604 190
wd 0 13631608 191
wd 0 13631612 192
wd 0 14680128 193
wd 0 14680132 194
wd 0 14680136 195
wd 0 14680140 196
wd 0 14680144 197
wd 0 14680148 198
wd 0 14680152 199
wd 0 14680156 200
wd 0 14680160 201
wd 0 14680164 202
wd 0 14680168 203
wd 0 14680172 204
wd 0 14680176 205
wd 0 14680180 206
wd 0 14680184 207
wd 0 14680188 208
wd 0 15728704 209
wd 0 15728708 210
wd 0 15728712 211
wd 0 15728716 212
wd 0 15728720 213
wd 0 15728724 214
wd 0 15728728 215
wd 0 15728732 216
wd 0 15728736 217
wd 0 15728740 218
wd 0 15728744 219
wd 0 15728748 220
wd 0 15728752 221
wd 0 15728756 222
wd 0 15728760 223
wd 0 15728764 224
wd 0 16777280 225
wd 0 16777284 226
wd 0 16777288 227
wd 0 16777292 228
wd 0 16777296 229
wd 0 16777300 230
wd 0 16777304 231
wd 0 16777308 232
wd 0 16777312 233
wd 0 16777316 234
wd 0 16777320 235
wd 0 16777324 236
wd 0 16777328 237
wd 0 16777332 238
wd 0 16777336 239
wd 0 16777340 240
wd 0 17825856 241
wd 0 17825860 242
wd 0 17825864 243
wd 0 17825868 244
wd 0 17825872 245
wd 0 17825876 246
wd 0 17825880 247
wd 0 17825884 248
wd 0 17825888 249
wd 0 17825892 250
wd 0 17825896 251
wd 0 17825900 252
wd 0 17825904 253
wd 0 17825908 254
wd 0 17825912 255
wd 0 17825916 256
